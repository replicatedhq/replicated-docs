import EmbeddedClusterRequirements from "../partials/embedded-cluster/_requirements.mdx"
import EmbeddedClusterPortRequirements from "../partials/embedded-cluster/_port-reqs.mdx"
import FirewallOpeningsIntro from "../partials/install/_firewall-openings-intro.mdx"
import FirewallOpeningsEc from "../partials/install/_firewall-openings-embedded-cluster.mdx"

# Embedded Cluster Installation Requirements

This topic lists the installation requirements for Replicated Embedded Cluster. Ensure that the installation environment meets these requirements before attempting to install.

## System Requirements

<EmbeddedClusterRequirements/>

## Port Requirements

<EmbeddedClusterPortRequirements/>

## Unix Accounts for Kubernetes Components

During installation, Embedded Cluster automatically creates the following Unix accounts that are required by internal Kubernetes components:

* **etcd**: Used by the Kubernetes etcd database, which stores cluster state.
* **konnectivity-server**: Used by the Konnectivity service, which facilitates secure communication between internal components.
* **kube-apiserver**: Used by the Kubernetes API server.
* **kube-scheduler**: Used by the Kubernetes scheduler to schedule workloads such as pods.

No action is required to create these roles. Removing them will make the cluster non-functional.

For more information about the internal Kubernetes components, see [Kubernetes Components](https://kubernetes.io/docs/concepts/overview/components/) in the Kubernetes documentation.

For more information about the Konnectivity service, see [Set up Konnectivity service](https://kubernetes.io/docs/tasks/extend-kubernetes/setup-konnectivity/) in the Kubernetes documentation.

## Firewall Openings for Online Installations with Embedded Cluster {#firewall}

<FirewallOpeningsIntro/>

<FirewallOpeningsEc/>

:::note
If you monitor the outbound traffic attempts made by Embedded Cluster, you might see an attempted call to `updates.k0sproject.io` approximately every 30 minutes. These calls are made by a feature of the upstream k0s project called `update-prober`, which checks for k0s updates. Embedded Cluster does not use the `update-prober` feature and blocking it in your firewall rules will not affect Replicated product functionality.
:::

## About Firewalld Configuration

When Firewalld is enabled in the installation environment, Embedded Cluster modifies the Firewalld config to allow traffic over the pod and service networks and to open the required ports on the host. No additional configuration is required.

The following rule is added to Firewalld:

```xml
<?xml version="1.0" encoding="utf-8"?>
<zone target="ACCEPT">
  <interface name="cali+"/>
  <interface name="tunl+"/>
  <interface name="vxlan-v6.calico"/>
  <interface name="vxlan.calico"/>
  <interface name="wg-v6.cali"/>
  <interface name="wireguard.cali"/>
  <source address="[pod-network-cidr]"/>
  <source address="[service-network-cidr]"/>
</zone>
```

The following ports are opened in the default zone:

<table>
<tr>
  <th>Port</th>
  <th>Protocol</th>
</tr>
<tr>
  <td>6443</td>
  <td>TCP</td>
</tr>
<tr>
  <td>10250</td>
  <td>TCP</td>
</tr>
<tr>
  <td>9443</td>
  <td>TCP</td>
</tr>
<tr>
  <td>2380</td>
  <td>TCP</td>
</tr>
<tr>
  <td>4789</td>
  <td>UDP</td>
</tr>
</table>
